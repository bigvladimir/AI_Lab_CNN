# Отчёт по лабораторной работе
## Свёрточные нейронные сети

### Студенты: 

| ФИО       | Роль в проекте                     | Оценка       |
|-----------|------------------------------------|--------------|
| Харченко В. М. | 1, 2 задания |          |

> *Комментарии проверяющего*


## Задание 1.

Необходимо было придумать архитектуру сверточной нейронной сети для классификации изображений. Для работы был выбран Tensorflow.

Архитектура следующая:
[Rescaling + MaxPooling + Relu] *3 + Dropout + Dense + Softmax

Перед обучением выполняется аугментация изображений и нормировка.

- Loss - CrossEntropy
- Optimizer - Adam
- LR - 1е-3
- Epochs - 50

Полученные метрики:

- Accuracy: 0.62
- top 3 accuracy: 0.85
- Точность бинарной классификации cats VS dogs: 0.94

Графики в зависимости от эпох:
![графики](https://github.com/bigvladimir/AI_Lab_CNN/blob/main/images/graphics.png)

Матрица неточностей:

![матрица задание 1](https://github.com/bigvladimir/AI_Lab_CNN/blob/main/images/matrix.png)

Лучше всего модель справилась с бинарной классификацией кошек и собак. Также заметим, что левая нижняя и правая верхняя части матрицы неточностей почти нулевые.

Определять непосредственно породы кошек и собак модель может не всегда. Имеем точность 0.67. Однако в 88% случаев правильная порода находится в топ 3 предсказаниях модели.

## Задание 2.
Необходимо было использовать предобученные модели для классификации собак и кошек по породам. Для работы использован Torch.

Использованы сети VGG-16 и ResNet-18. Обе были предобучены на ImageNet. В каждой сети заменен последний полносвязный слой, чтобы классов на выходе было столько, сколько в данном датасете.

Так как модели предобучены, то они уже неплохо справляются. Это значит, что не нужно много эпох на дообучение, поэтому сделано всего 2 эпохи обучения. Обе сети показали себя примерно одинаково - получили accuracy 0.80 - 0.81.

Графики в зависимости от эпох:

![loss](https://github.com/bigvladimir/AI_Lab_CNN/blob/main/images/graph_loss_task2.png)

![accuracy](https://github.com/bigvladimir/AI_Lab_CNN/blob/main/images/graph_acc_task2.png)

Матрица неточностей:
![матрица задание 2](https://github.com/bigvladimir/AI_Lab_CNN/blob/main/images/matrix_task2.png)

Точность бинарной классификации кошек и собак была "прикинута" из-за невозможности классификации. Случаев, когда нейросеть путает кошек и собак мало - не более 50. Соответсвтенно точность классификации кошек и собак равна ~96%.

## Вывод

В процессе выполнения лабораторной работы было проведено обучение сверточных нейросетей для классификации изображений. Выяснилось что подход с предобучением оказался более точным из-за инициализации модели весами, полученных после обучения на ImageNet. Также был опробован фреймворк Tensorflow.
